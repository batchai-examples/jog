{
    "path": "static/grok_vjeantet/junos.go",
    "model_usage_metrics": {
        "Duration": 49539287386,
        "OpenAiUsage": {
            "completion_tokens": 0,
            "prompt_tokens": 0,
            "total_tokens": 0,
            "completion_tokens_details": {
                "accepted_prediction_tokens": 0,
                "audio_tokens": 0,
                "reasoning_tokens": 0,
                "rejected_prediction_tokens": 0
            },
            "prompt_tokens_details": {
                "audio_tokens": 0,
                "cached_tokens": 0
            }
        }
    },
    "test_file_path": "static/grok_vjeantet/junos_test.go",
    "existing_test_code": "",
    "original_code": "package grok_vjeantet \n\nconst (\n  // Junos ...\n  Junos string = `# JUNOS 11.4 RT_FLOW patterns\nRT_FLOW_EVENT (RT_FLOW_SESSION_CREATE|RT_FLOW_SESSION_CLOSE|RT_FLOW_SESSION_DENY)\n\nRT_FLOW1 %{RT_FLOW_EVENT:event}: %{GREEDYDATA:close-reason}: %{IP:src-ip}/%{INT:src-port}-\u003e%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{IP:nat-src-ip}/%{INT:nat-src-port}-\u003e%{IP:nat-dst-ip}/%{INT:nat-dst-port} %{DATA:src-nat-rule-name} %{DATA:dst-nat-rule-name} %{INT:protocol-id} %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} %{INT:session-id} \\d+\\(%{DATA:sent}\\) \\d+\\(%{DATA:received}\\) %{INT:elapsed-time} .*\n\nRT_FLOW2 %{RT_FLOW_EVENT:event}: session created %{IP:src-ip}/%{INT:src-port}-\u003e%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{IP:nat-src-ip}/%{INT:nat-src-port}-\u003e%{IP:nat-dst-ip}/%{INT:nat-dst-port} %{DATA:src-nat-rule-name} %{DATA:dst-nat-rule-name} %{INT:protocol-id} %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} %{INT:session-id} .*\n\nRT_FLOW3 %{RT_FLOW_EVENT:event}: session denied %{IP:src-ip}/%{INT:src-port}-\u003e%{IP:dst-ip}/%{INT:dst-port} %{DATA:service} %{INT:protocol-id}\\(\\d\\) %{DATA:policy-name} %{DATA:from-zone} %{DATA:to-zone} .*\n\n`\n)\n",
    "test_code": "package grok_vjeantet\n\nimport (\n\t\"testing\"\n)\n\nfunc TestJunosPatternRT_FLOW_EVENT(t *testing.T) {\n\ttestCases := []struct {\n\t\tinput    string\n\t\texpected map[string]string\n\t}{\n\t\t{\n\t\t\tinput: `RT_FLOW_SESSION_CREATE: session created 192.168.1.1/5000-\u003e192.168.1.2/6000 SSH 10.0.0.1/5001-\u003e10.0.0.2/6001 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside 12345 sent(100) received(200) 10 .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_CREATE\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.1\",\n\t\t\t\t\"src-port\":             \"5000\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.2\",\n\t\t\t\t\"dst-port\":             \"6000\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.1\",\n\t\t\t\t\"nat-src-port\":         \"5001\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.2\",\n\t\t\t\t\"nat-dst-port\":         \"6001\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t\t\"session-id\":           \"12345\",\n\t\t\t\t\"sent\":                 \"100\",\n\t\t\t\t\"received\":             \"200\",\n\t\t\t\t\"elapsed-time\":         \"10\",\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tinput: `RT_FLOW_SESSION_CLOSE: session closed 192.168.1.3/5002-\u003e192.168.1.4/6002 SSH 10.0.0.3/5003-\u003e10.0.0.4/6003 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside 12346 sent(150) received(250) 15 .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_CLOSE\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.3\",\n\t\t\t\t\"src-port\":             \"5002\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.4\",\n\t\t\t\t\"dst-port\":             \"6002\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.3\",\n\t\t\t\t\"nat-src-port\":         \"5003\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.4\",\n\t\t\t\t\"nat-dst-port\":         \"6003\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t\t\"session-id\":           \"12346\",\n\t\t\t\t\"sent\":                 \"150\",\n\t\t\t\t\"received\":             \"250\",\n\t\t\t\t\"elapsed-time\":         \"15\",\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tinput: `RT_FLOW_SESSION_DENY: session denied 192.168.1.5/5004-\u003e192.168.1.6/6004 SSH 10.0.0.5/5005-\u003e10.0.0.6/6005 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_DENY\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.5\",\n\t\t\t\t\"src-port\":             \"5004\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.6\",\n\t\t\t\t\"dst-port\":             \"6004\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.5\",\n\t\t\t\t\"nat-src-port\":         \"5005\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.6\",\n\t\t\t\t\"nat-dst-port\":         \"6005\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tinput: `RT_FLOW1 RT_FLOW_SESSION_CREATE: session created 192.168.1.7/5006-\u003e192.168.1.8/6006 SSH 10.0.0.7/5007-\u003e10.0.0.8/6007 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside 12347 sent(200) received(300) 20 .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_CREATE\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.7\",\n\t\t\t\t\"src-port\":             \"5006\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.8\",\n\t\t\t\t\"dst-port\":             \"6006\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.7\",\n\t\t\t\t\"nat-src-port\":         \"5007\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.8\",\n\t\t\t\t\"nat-dst-port\":         \"6007\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t\t\"session-id\":           \"12347\",\n\t\t\t\t\"sent\":                 \"200\",\n\t\t\t\t\"received\":             \"300\",\n\t\t\t\t\"elapsed-time\":         \"20\",\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tinput: `RT_FLOW1 RT_FLOW_SESSION_CLOSE: session closed 192.168.1.9/5008-\u003e192.168.1.10/6008 SSH 10.0.0.9/5009-\u003e10.0.0.10/6009 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside 12348 sent(250) received(350) 25 .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_CLOSE\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.9\",\n\t\t\t\t\"src-port\":             \"5008\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.10\",\n\t\t\t\t\"dst-port\":             \"6008\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.9\",\n\t\t\t\t\"nat-src-port\":         \"5009\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.10\",\n\t\t\t\t\"nat-dst-port\":         \"6009\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t\t\"session-id\":           \"12348\",\n\t\t\t\t\"sent\":                 \"250\",\n\t\t\t\t\"received\":             \"350\",\n\t\t\t\t\"elapsed-time\":         \"25\",\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tinput: `RT_FLOW1 RT_FLOW_SESSION_DENY: session denied 192.168.1.11/5010-\u003e192.168.1.12/6010 SSH 10.0.0.11/5011-\u003e10.0.0.12/6011 NAT-RULE-OUTSIDE NAT-RULE-INSIDE 6 HTTP outside inside .`,\n\t\t\texpected: map[string]string{\n\t\t\t\t\"event\":                \"RT_FLOW_SESSION_DENY\",\n\t\t\t\t\"close-reason\":         \"\",\n\t\t\t\t\"src-ip\":               \"192.168.1.11\",\n\t\t\t\t\"src-port\":             \"5010\",\n\t\t\t\t\"dst-ip\":               \"192.168.1.12\",\n\t\t\t\t\"dst-port\":             \"6010\",\n\t\t\t\t\"service\":              \"SSH\",\n\t\t\t\t\"nat-src-ip\":           \"10.0.0.11\",\n\t\t\t\t\"nat-src-port\":         \"5011\",\n\t\t\t\t\"nat-dst-ip\":           \"10.0.0.12\",\n\t\t\t\t\"nat-dst-port\":         \"6011\",\n\t\t\t\t\"src-nat-rule-name\":    \"NAT-RULE-OUTSIDE\",\n\t\t\t\t\"dst-nat-rule-name\":    \"NAT-RULE-INSIDE\",\n\t\t\t\t\"protocol-id\":          \"6\",\n\t\t\t\t\"policy-name\":          \"HTTP\",\n\t\t\t\t\"from-zone\":            \"outside\",\n\t\t\t\t\"to-zone\":              \"inside\",\n\t\t\t\t\"session-id\":           \"\",\n\t\t\t\t\"sent\":                 \"\",\n\t\t\t\t\"received\":             \"\",\n\t\t\t\t\"elapsed-time\":         \"\",\n\t\t\t},\n\t\t},\n\t}\n\n\tfor _, tc := range testCases {\n\t\tresult, err := parseFlow(tc.input)\n\t\tif err != nil {\n\t\t\tt.Errorf(\"parseFlow(%q) error: %v\", tc.input, err)\n\t\t} else if !reflect.DeepEqual(result, tc.expected) {\n\t\t\tt.Errorf(\"parseFlow(%q) = %v; want %v\", tc.input, result, tc.expected)\n\t\t}\n\t}\n}\n",
    "amount_of_generated_test_cases": 10,
    "single_test_run_command": "go test -v static/grok_vjeantet/junos_test.go"
}